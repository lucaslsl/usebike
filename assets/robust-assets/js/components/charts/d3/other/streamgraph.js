$(window).on("load",function(){function a(a){function b(b){for(var c=1/(.1+Math.random()),d=2*Math.random()-.5,e=10/(.1+Math.random()),f=0;f<a;f++){var g=(f/a-d)*e;b[f]+=c*Math.exp(-g*g)}}var c,d=[];for(c=0;c<a;++c)d[c]=0;for(c=0;c<5;++c)b(d);return d.map(function(a,b){return{x:b,y:Math.max(0,a)}})}var b=d3.select("#streamgraph"),c={top:20,right:20,bottom:30,left:50},d=b.node().getBoundingClientRect().width-c.left-c.right,e=500-c.top-c.bottom,f=20,g=200,h=d3.layout.stack().offset("wiggle"),i=h(d3.range(f).map(function(){return a(g)})),j=h(d3.range(f).map(function(){return a(g)})),k=d3.scale.linear().domain([0,g-1]).range([0,d]),l=d3.scale.linear().domain([0,d3.max(i.concat(j),function(a){return d3.max(a,function(a){return a.y0+a.y})})]).range([e,0]),m=d3.scale.linear().range(["#99B898","#FECEA8"]),n=d3.svg.area().x(function(a){return k(a.x)}).y0(function(a){return l(a.y0)}).y1(function(a){return l(a.y0+a.y)}),o=b.append("svg"),p=o.attr("width",d).attr("height",e);p.selectAll("path").data(i).enter().append("path").attr("d",n).style("fill",function(){return m(Math.random())})});