$(window).on("load",function(){var a=d3.select("#vertical-sankey"),b={top:20,right:20,bottom:30,left:50},c=a.node().getBoundingClientRect().width-b.left-b.right,d=650-b.top-b.bottom,e=d3.format(",.0f"),f=function(a){return e(a)+"m CHF"},g=d3.scale.ordinal().range(["#99B898","#FECEA8","#FF847C","#E84A5F","#F8B195","#F67280","#C06C84"]),h=a.append("svg"),i=h.attr("width",c+b.left+b.right).attr("height",d+b.top+b.bottom).append("g").attr("transform","translate("+b.left+","+b.top+")"),j=d3.sankey().nodeWidth(25).nodePadding(20).size([c,d]),k=j.link();d3.json("robust-assets/demo-data/d3/other/sankey.json",function(a,b){function d(a){d3.select(this).attr("transform","translate("+(a.x=Math.max(0,Math.min(c-a.dy,d3.event.x)))+","+a.y+")"),j.relayout(),e.attr("d",k)}if(a)throw a;j.nodes(b.nodes).links(b.links).layout(32);var e=i.append("g").selectAll(".link").data(b.links).enter().append("path").attr("class","link").attr("d",k).style("stroke-width",function(a){return Math.max(1,a.dy)}).style("stroke",function(a){return a.source.color=g(a.source.name.replace(/ .*/,""))}).style("fill","none").style("stroke-opacity","0.5").sort(function(a,b){return b.dy-a.dy});e.append("title").text(function(a){return a.source.name+" â†’ "+a.target.name+"\n"+f(a.value)});var h=i.append("g").selectAll(".node").data(b.nodes).enter().append("g").attr("class","node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).call(d3.behavior.drag().origin(function(a){return a}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",d));h.append("rect").attr("height",j.nodeWidth()).attr("width",function(a){return a.dy}).style("fill",function(a){return a.color=g(a.name.replace(/ .*/,""))}).style("stroke",function(a){return d3.rgb(a.color).darker(2)}).style("fill-opacity","0.9").append("title").text(function(a){return a.name+"\n"+f(a.value)}),h.append("text").attr("text-anchor","middle").attr("x",function(a){return a.dy/2}).attr("y",j.nodeWidth()/2).attr("dy",".35em").text(function(a){return a.name}).filter(function(a){return a.x<c/2})})});